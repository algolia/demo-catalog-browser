{"version":3,"sources":["widgets/Carousel.js","app.js"],"names":["renderCarousel","isFirstRender","widgetParams","hits","container","document","querySelector","wrapper","createElement","classList","add","appendChild","carouselTitle","textContent","title","carouselListContainer","setAttribute","context","style","width","window","innerWidth","getBoundingClientRect","left","leftArrow","innerHTML","rightArrow","transform","display","right","addEventListener","scroll","clientWidth","ul","map","hit","index","objectID","length","image","genre","join","customCarousel","instantsearch","connectors","connectHits","searchClient","algoliasearch","search","indexName","referenceHit","color","popularity_score","actors","ongoing_watch","tmdb_id","views_last_7_days","days_to_expire","myCarousels","extraConfig","facetFilters","hitsPerPage","relatedRef","addWidgets","carousel","widgets","indexId","configure","ruleContexts","query","EXPERIMENTAL_configureRelatedItems","matchingPatterns","score","start","e","target","matches","console","log","dataset","objectId","aa","eventName","objectIDs","Math","floor","random"],"mappings":"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","file":"app.61357ad5.js","sourceRoot":"../src","sourcesContent":["/**\n * @requires module:instantsearch\n */\n\nconst renderCarousel = ({ widgetParams, hits }, isFirstRender) => {\n  const container = document.querySelector(widgetParams.container);\n\n  if (isFirstRender) {\n    const wrapper = document.createElement('div');\n    wrapper.classList.add('carousel-single');\n\n    container.appendChild(wrapper);\n\n    const carouselTitle = document.createElement('h2');\n    carouselTitle.textContent = widgetParams.title;\n    wrapper.appendChild(carouselTitle);\n\n    const carouselListContainer = document.createElement('ul');\n    carouselListContainer.classList.add('carousels__list-container');\n    carouselListContainer.setAttribute('id', widgetParams.context);\n    wrapper.appendChild(carouselListContainer);\n\n    wrapper.style.width = `${window.innerWidth -\n      wrapper.getBoundingClientRect().left}px`;\n\n    const leftArrow = document.createElement('button');\n    leftArrow.innerHTML =\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-arrow-right-circle\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 16 16 12 12 8\"></polyline><line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line></svg>';\n    wrapper.appendChild(leftArrow);\n    const rightArrow = document.createElement('button');\n    rightArrow.innerHTML =\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-arrow-right-circle\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 16 16 12 12 8\"></polyline><line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line></svg>';\n    rightArrow.style.transform = 'rotate(180deg)';\n    rightArrow.style.display = 'none';\n    rightArrow.style.right = 'auto';\n    rightArrow.style.left = '16px';\n    wrapper.appendChild(rightArrow);\n\n    leftArrow.addEventListener('click', () => {\n      carouselListContainer.scroll(wrapper.clientWidth, 0);\n      leftArrow.style.display = 'none';\n      rightArrow.style.display = 'block';\n    });\n    rightArrow.addEventListener('click', () => {\n      carouselListContainer.scroll(0, 0);\n      rightArrow.style.display = 'none';\n      leftArrow.style.display = 'block';\n    });\n  }\n\n  const ul = container.querySelector(`ul#${widgetParams.context}`);\n  ul.innerHTML = hits\n    .map(\n      (hit, index) => `\n        <li class=\"analytics\" data-object-id=\"${hit.objectID}\" style=\"${\n        index === hits.length - 1\n          ? `padding-right: ${ul.getBoundingClientRect().left + 180}px`\n          : ''\n      }\">\n            <img src=\"${hit.image}\" alt=\"${hit.title}\">\n            <h3>${hit.title}</h3>\n            <ul>\n                ${hit.genre\n                  .map(\n                    genre => `\n                    <li>${genre}</li>\n                `\n                  )\n                  .join('')}\n            </ul>\n        </li>\n    `\n    )\n    .join('');\n};\n\nexport const customCarousel = instantsearch.connectors.connectHits(\n  renderCarousel\n);\n","import { customCarousel } from './widgets/Carousel';\n\n/* global algoliasearch instantsearch */\nconst searchClient = algoliasearch(\n  'GENYJWQIK2',\n  'd7a56394e700ad117ef483c12bc04481'\n);\n\nconst search = instantsearch({\n  indexName: 'perso_movies_carousel',\n  searchClient,\n});\n\nconst referenceHit = {\n  title: 'The Imitation Game',\n  image: 'https://image.tmdb.org/t/p/w154/ntZGfHt4d73A9fDD4KUN4nbDQlq.jpg',\n  color: '#192229',\n  popularity_score: 108.4335114104872,\n  actors: ['Benedict Cumberbatch', 'Keira Knightley', 'Matthew Goode'],\n  genre: ['History', 'Drama', 'Thriller', 'War'],\n  ongoing_watch: [],\n  tmdb_id: 205596,\n  views_last_7_days: 596898,\n  days_to_expire: 44,\n  objectID: '439434880',\n};\n\nconst myCarousels = [\n  {\n    title: 'Trending',\n    context: 'trending',\n    indexName: 'perso_movies_carousel_trending',\n  },\n  {\n    title: 'Most Popular',\n    context: 'most-popular',\n    indexName: 'perso_movies_carousel',\n  },\n  {\n    title: 'Last chance',\n    context: 'last-chance',\n    indexName: 'perso_movies_carousel_last_chance',\n  },\n  {\n    title: 'You started watching',\n    context: 'ongoing',\n    indexName: 'perso_movies_carousel',\n    extraConfig: {\n      facetFilters: 'ongoing_watch: user_1',\n      hitsPerPage: 5,\n    },\n  },\n  {\n    title: 'Because you watched The Imitation Game',\n    context: 'related',\n    indexName: 'perso_movies_carousel_related',\n    relatedRef: referenceHit,\n  },\n  {\n    title: 'Fantasy Comedy',\n    context: 'comedy_fantasy',\n    indexName: 'perso_movies_carousel',\n  },\n];\n\nsearch.addWidgets(\n  myCarousels.map(carousel =>\n    instantsearch.widgets\n      .index({\n        indexName: carousel.indexName,\n        indexId: carousel.context,\n      })\n      .addWidgets(\n        !carousel.relatedRef\n          ? [\n              instantsearch.widgets.configure({\n                ruleContexts: carousel.context,\n                hitsPerPage: 15,\n                query: '',\n                ...carousel.extraConfig,\n              }),\n              customCarousel({\n                container: '.carousels',\n                title: carousel.title,\n                context: carousel.context,\n              }),\n            ]\n          : [\n              instantsearch.widgets.configure({\n                ruleContexts: carousel.context,\n                hitsPerPage: 15,\n                query: '',\n                ...carousel.extraConfig,\n              }),\n              instantsearch.widgets.EXPERIMENTAL_configureRelatedItems({\n                hit: carousel.relatedRef,\n                matchingPatterns: {\n                  genre: { score: 3 },\n                  actors: { score: 2 },\n                },\n              }),\n              customCarousel({\n                container: '.carousels',\n                title: carousel.title,\n                context: carousel.context,\n              }),\n            ]\n      )\n  )\n);\n\nsearch.start();\n\ndocument.addEventListener('click', e => {\n  if (e.target.matches('.analytics')) {\n    console.log('click', e.target.dataset.objectId);\n\n    aa('clickedObjectIDs', {\n      index: 'perso_movies_carousel',\n      eventName: 'CLICKED_MOVIE',\n      objectIDs: [e.target.dataset.objectId],\n    });\n\n    aa('viewedObjectIDs', {\n      index: 'perso_movies_carousel',\n      eventName: 'VIEWED_MOVIE',\n      objectIDs: [e.target.dataset.objectId],\n    });\n\n    if (Math.floor(Math.random() * 10) < 4) {\n      aa('convertedObjectIDs', {\n        index: 'perso_movies_carousel',\n        eventName: 'WATCHED_MOVIE',\n        objectIDs: [e.target.dataset.objectId],\n      });\n    }\n  }\n});\n"]}